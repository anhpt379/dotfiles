# vim: ft=conf fileencoding=utf-8

include aodark.conf

kitty_mod cmd

font_size   14
font_family MesloLGM Nerd Font
italic_font MesloLGM Nerd Font Italic
bold_font   MesloLGM Nerd Font Bold

# Cursor customization
cursor_shape beam
cursor_blink_interval 0

# Mouse
copy_on_select yes
strip_trailing_spaces smart

select_by_word_characters @-./_~?&=%+#:[]

click_interval 0.3
mouse_map cmd+left release grabbed,ungrabbed mouse_click_url
mouse_map cmd+left press grabbed mouse_discard_event

# Use the option key as an alt key
macos_option_as_alt yes

# Turn off anti-aliasing
macos_thicken_font 0

# Hide window title in macOS menubar
macos_show_window_title_in window

# Hide title bar
hide_window_decorations titlebar-only

# Enable programming ligatures (?? ** .. ++ ~~ == != >= <= -> <- ~> => =~ += __ \n ||)
# https://github.com/tonsky/FiraCode
font_features FiraCodeRoman-Regular +ss01 +ss02 +ss03 +ss04 +ss05 +ss06 -ss07 +ss08
#           ?    .    *    +    ~    \    _    -    <    >    *    :    ;    ,    |    =   https://unicode-search.net/unicode-namesearch.pl
symbol_map U+3f,U+2e,U+2a,U+2b,U+7e,U+5c,U+5f,U+2d,U+3c,U+3e,U+2a,U+3a,U+3b,U+2c,U+7c,U+3d Fira Code Retina

# Enable the new shiny Fira Code's progress bar: https://user-images.githubusercontent.com/3440094/144696997-c9a6383c-7c7c-4786-8f56-3f385b3f850a.png
symbol_map U+EE00,U+EE01,U+EE02,U+EE03,U+EE04,U+EE05,U+EE06,U+EE07,U+EE08,U+EE09,U+EE0A,U+EE0B Fira Code Retina

disable_ligatures cursor

enable_audio_bell no
macos_quit_when_last_window_closed yes

macos_titlebar_color background

# Tab style
tab_activity_symbol *
tab_bar_edge top
tab_switch_strategy last

# Give the title some breathing space
tab_title_template " {title} "

# Non-italic active tab
active_tab_font_style bold

# Smart case history search
scrollback_pager ~/.config/kitty/pager.sh 'INPUT_LINE_NUMBER' 'CURSOR_LINE' 'CURSOR_COLUMN'

# Number of lines of history to keep in memory for scrolling back
scrollback_lines 50000

# Bigger scrollback size (in MB)
scrollback_pager_history_size 1024

# Fill new space with lines from the scrollback buffer after enlarging a window
scrollback_fill_enlarged_window yes

# Tab jumping
map cmd+n next_tab
map cmd+p previous_tab
map cmd+[ move_tab_backward
map cmd+] move_tab_forward

# Font size adjustment
map cmd+ctrl+= change_font_size all +1.0
map cmd+ctrl+- change_font_size all -1.0
map cmd+ctrl+0 change_font_size all 0

# Layout management
enabled_layouts fat:bias=90,fat:bias=30
active_border_color #474e5d
inactive_border_color #313640

# Resize split
map cmd+'     next_layout
map cmd+=     resize_window taller   4
map cmd+-     resize_window shorter  4
map cmd+up    resize_window taller   2
map cmd+down  resize_window shorter  2
map cmd+left  resize_window wider    2
map cmd+right resize_window narrower 2

# Open new splits with the current working directory
map cmd+s new_window_with_cwd
map cmd+0 next_window
map cmd+9 previous_window

# Cmd+w (from vagrant) to work with both kitty windows & tabs
allow_remote_control yes
map cmd+w remote_control close-window

# Fix option+left/right doesn't jump between words
map alt+left send_text all \x1b\x62
map alt+right send_text all \x1b\x66

# macOS keychain integration
# Use this command to add a new password:
#
#   $ security add-generic-password -a kitty -s kitty -w
#
map cmd+BACKSLASH kitten kittens/password.py security find-generic-password -a "kitty" -w

# Keep the scrollback after Ctrl-L
# https://github.com/kovidgoyal/kitty/issues/1113#issuecomment-435588611
map ctrl+l combine : clear_terminal scroll active : send_text normal,application \x0c

# Fix Cmd+P to switch to the previous tab doesn't really work
# https://github.com/kovidgoyal/kitty/issues/3558
map ctrl+alt+super+p previous_tab
map ctrl+alt+super+n next_tab

# Disable opening new panel with cmd+enter (it's duplicated with ctrl+t, and I usually mistyped it)
map cmd+enter send_text \x24  # This sends ENTER when we type Command+ENTER

# Select the entire output of a command by right clicking on it
mouse_map right press ungrabbed mouse_select_command_output

# Open the output of the last command in pager
map cmd+o show_last_command_output

# Show scrollback with cmd+f
map cmd+f show_scrollback

# Disable the default Cmd+R mapping, since I accidentally pressed it sometimes
map cmd+r discard_event

# Use manual shell integration to make it work in vagrant
shell_integration disabled
